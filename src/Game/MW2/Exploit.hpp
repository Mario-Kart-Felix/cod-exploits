#pragma once

namespace Game
{
	namespace MW2
	{
		class Client;

		class Exploit
		{
		public:
			std::string buildPayload();

		private:
			void allocateMemory(std::vector<DWORD>* stack, DWORD address, DWORD size);
			void writeDataInEax(std::vector<DWORD>* stack, std::string data);
			void freeMemory(std::vector<DWORD>* stack, DWORD address);
			void writeData(std::vector<DWORD>* stack, DWORD address, std::string data);

			void pop(std::vector<DWORD>* stack, size_t params);

			void quit(std::vector<DWORD>* stack);
			void restore(std::vector<DWORD>* stack);
		};
	}
}
