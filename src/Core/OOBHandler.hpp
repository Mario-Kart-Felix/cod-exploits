#pragma once

#define OOB_MAGIC "\xFF\xFF\xFF\xFF"

namespace Core
{
	class OOBHandler
	{
	public:
		OOBHandler();

		bool handle(Network::Socket* sock, Network::Address address, std::string_view data);
		void connect(Network::Socket* sock, Network::Address addr, Utils::Slot<void(Network::Socket*, Network::Address)> callback);

	private:
		Utils::Slot<void(Network::Socket*, Network::Address)> readyHandler;
		std::map<std::string, Utils::Slot<void(Network::Socket*, Network::Address, std::string data)>> commandHandlers;

		void onCommand(std::string command, Utils::Slot<void(Network::Socket*, Network::Address, std::string data)> callback);
	};
}
